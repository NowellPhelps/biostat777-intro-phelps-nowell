[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I am a first year PhD student in the Department of Biostatistics at Johns Hopkins University. I am broadly interested in using data-driven modelling to inform effective and equitable policymaking and interventions, and am particularly interested in applications in international health.\nI hold an MMath in Mathematics from the University of Oxford. After graduating I worked as a Research Assistant in the Department of Epidemiology and Biostatistics at Imperial College London. While there I primarily worked on modelling trends in risk factors for noncommunicable diseases, through harmonising health survey data with a hierarchical Bayesian model. I also spent four months in Kigali, Rwanda, as a visiting researcher at the African Institute for Mathematical Sciences Research and Innovation Center.\nOutside of work I enjoy biking, climbing, reading, and travelling. Here is a photo of some train tracks."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Home",
    "section": "",
    "text": "My name is Nowell Phelps and I am a first year PhD student in the Department of Biostatistics at Johns Hopkins University. This website contains some information about my background and an example data analysis."
  },
  {
    "objectID": "data analysis.html",
    "href": "data analysis.html",
    "title": "Data analysis",
    "section": "",
    "text": "Introduction\nA recent paper showed published in the Lancet (Strain et al. 2024) showed that the prevalence of insufficient physical inactivity has been rising in most regions across the globe. Figure 1 below, taken from this paper, shows this near-universal rise. Furthermore, physical activity has been shown to be a stronger predictor of mortality than age (Leroux et al. 2024). In order to curb and reverse the increasing trends in physical inactivity, and to target interventions for increasing physical activity, it is important to understand variations in physical activity across different population subgroups.\n\n\n\nFigure 1: Trends in national prevalence of physical inactivity from 2000 to 2022, taken from Strain et al.\n\n\n\n\n\n\n\n\nNote\n\n\n\nInsufficient physical activity is typically defined as not doing 150 minutes of moderate-intensity activity, 75 minutes of vigorous-intensity activity, or an equivalent combination per week (Strain et al. 2024).\n\n\n\n\nAims\nIn this analysis I will attempt to characterise differences in phyiscal activity across different population subgroups using NHANES 2011-2012 and NHANES 2013-2014 cohorts, taken from (Crainiceanu 2023). These differences could of interest to public health practitioners interested in identifying population subgroups with low rates of physical activity, as these subgroups are those worth considering for targeted behavioural interventions.\n\n\n\n\n\n\nMonitor-Independent Movement Summary (MIMS).\n\n\n\nIn the dataset used in this analysis, physical activity is measured by Monitor-Independent Movement Summary (MIMS). This is a measure which compresses acceleration measured by a wrist-worn monitor on the X, Y, and Z axes into a single number, which is standardized across different devices.\n\n\n\n\n\n\n\n\nReading Code\n\n\n\nMy code is presented in blocks with See code labels. Please click on these to view the code.\n\n\n\n\nData preprocessing\nHere is a data dictionary of the variables used and the code used to preprocess these data. Some summary statistics of the data are presented in the margin on the right hand side.\n\n\nSee code\n# Initialise, read in data, and generate data dictionary\nrm(list = ls())\nlibrary(tidyverse)\nlibrary(ggridges)\nlibrary(grid)\nlibrary(gridExtra)\nlibrary(labelled)\n\n# Read data\ndata &lt;- data.frame(readRDS(\"nhanes_fda_with_r.rds\"))\n\n# Subset to variables of interest\ndata &lt;- data %&gt;% select(\"SEQN\", \"MIMS\", \"gender\", \"age\")\n\ndictionary &lt;- generate_dictionary(data)\nlabels &lt;- c(\"Participant ID\",\n            \"Compressed minute-level wrist acceleration each minute\", \n            \"Participant gender\",\n            \"Participant age\")\n\ndictionary$label &lt;- labels\n\npretty_dictionary &lt;- dictionary %&gt;%\n  select(-c(pos, missing, levels, value_labels))\n\nknitr::kable(\n  pretty_dictionary, label = \"Data Dictionary\"\n)\n\n\n\n\n\n\n\n\n\n\nvariable\nlabel\ncol_type\n\n\n\n\nSEQN\nParticipant ID\ndbl\n\n\nMIMS\nCompressed minute-level wrist acceleration each minute\nI&lt;dbl[,1440]&gt;[,1440]\n\n\ngender\nParticipant gender\nfct\n\n\nage\nParticipant age\ndbl\n\n\n\n\n\nSee code\n# print(paste0(\"Number of participants: \", as.numeric(length(unique(data$SEQN)))))\n\n# DATA WRANGLING AND PREPROCESSING\nmims_t &lt;- data %&gt;% \n  select(-c(\"SEQN\", \"gender\", \"age\")) %&gt;%\n  t(.)\ncolnames(mims_t) &lt;- as.character(data$SEQN)\nmims_t &lt;- data.frame(mims_t)\n\nminute &lt;-seq(1, 1440, 1)\n\nmims_t$minute &lt;- minute\n\nmims_t &lt;- mims_t %&gt;%\n  pivot_longer(cols = setdiff(colnames(mims_t), \"minute\"), names_to = \"SEQN\", values_to = \"mims\")\n\nmims_t &lt;- mims_t %&gt;%  left_join(.,data %&gt;% select(\"SEQN\",\"gender\", \"age\") %&gt;% mutate(SEQN = paste0(\"X\", SEQN)), by = \"SEQN\")\n\n# Explore across sex and age\n# summary(mims_t$age)\n\nmims_t &lt;- mims_t %&gt;% \n  mutate(age_group = ifelse(age &lt;10, \"&lt;10 years\",\n                            ifelse(age&lt;20, \"10-19 years\",\n                                   ifelse(age &lt; 35, \"20-34 years\",\n                                          ifelse(age&lt;50, \"35-49 years\",\n                                                 ifelse(age &lt; 65, \"50-64 years\", \"65+ years\")))))) %&gt;% \n  mutate(minute_group = ifelse(minute &lt; 60*6, \"12am-6am\",\n                            ifelse(minute &lt; 60*12, \"6am-12pm\",\n                                   ifelse(minute&lt;60*18, \"12pm-6pm\",\"6pm-12am\"))))\n\ndata_summary &lt;- mims_t %&gt;%\n  select(SEQN, age_group, gender) %&gt;%\n  group_by(SEQN, age_group, gender) %&gt;%\n  distinct(.)\n\nage_summary &lt;- data.frame(\"Summary stat\" = names(summary(data$age)),\n                          \"Value (years)\" = as.double(summary(data$age)))\n\n\n\n\nSee code\nknitr::kable(\n  table(data_summary$age_group, data_summary$gender),\n  caption = \"Numbers of participants by age group and gender\"\n)\n\n\n\n\nNumbers of participants by age group and gender\n\n\n\nMale\nFemale\n\n\n\n\n&lt;10 years\n925\n842\n\n\n10-19 years\n1238\n1304\n\n\n20-34 years\n983\n965\n\n\n35-49 years\n963\n1112\n\n\n50-64 years\n1054\n1180\n\n\n65+ years\n987\n1057\n\n\n\n\n\n\nSee code\nknitr::kable(\n  age_summary,\n  caption = \"Summary of age distribution in dataset\"\n)\n\n\n\n\nSummary of age distribution in dataset\n\n\nSummary.stat\nValue..years.\n\n\n\n\nMin.\n3.00000\n\n\n1st Qu.\n14.00000\n\n\nMedian\n35.00000\n\n\nMean\n36.90167\n\n\n3rd Qu.\n57.00000\n\n\nMax.\n80.00000\n\n\n\n\n\n\nVisualisations of dataset\nIn the below plots we have averaged mims within subsequent ten miniute intervals in order to slightly reduce the noisiness of the data in the visualisations.\n\n\nSee code\n# Smooth by 10 minute intervals\nmims_smoothed &lt;- mims_t %&gt;%\n  mutate(time = floor(minute/10)*10) %&gt;%\n  group_by(time, gender, age, SEQN, age_group) %&gt;%\n  summarise(mims = mean(mims))\n\n\nmims_summarise &lt;- mims_smoothed %&gt;% \n  group_by(time, gender) %&gt;%\n  summarise(mean = mean(mims),\n            q_025 = quantile(mims, 0.025),\n            q_975 = quantile(mims, 0.975))\n\nmims_summarise_long &lt;- mims_summarise %&gt;%\n  pivot_longer(cols = c(mean, q_025, q_975), names_to = \"stat\", values_to = \"mims\")\n\n\n# PLOTTING\nmims_colour_scale &lt;- scale_color_gradientn(colours = c(\"blue\", \"red4\"), \n                                           limits = c(0, 50),\n                                           name =  \"(mims)\")\n\n  \ndata_hlines &lt;- data.frame(mims = c(0, 10, 20, 30), \n                          minute = seq(1:1440))\n\ndata_vlines &lt;- data.frame(minute = seq(60,1440, by = 60))\n\n# SUBSET FOR TESTING (REMOVE LATER)\n\n# COORD VERSION\nmax_measure &lt;- 90\nvlines &lt;- data.frame(loc = 1:24, yend = max_measure)\nhlines &lt;- data.frame(mims = seq(0, max_measure, by = 10))\n\ndata_plot &lt;- mims_smoothed \n\np2 &lt;- ggplot(data_plot, aes(x = time, y = mims, group = SEQN)) +\n  geom_line(aes(colour = mims), alpha = 0.1) +\n  geom_line(data = mims_summarise_long, inherit.aes = F, aes(x = time, y = mims, group = stat, colour = mims)) +\n  mims_colour_scale +\n  coord_polar() +\n  theme_classic() +\n  scale_x_continuous(breaks = c(6, 12, 18, 24)*60, \n                     labels = c(\"6am\", \"12pm\", \"6pm\", \"12am\"), \n                     expand = expansion(0,0)) +\n  geom_segment(inherit.aes = F, data= vlines*60, aes(x = loc, xend = loc, y = 0, yend = max_measure), colour=grey(0.1), linewidth=0.05) +\n  geom_segment(inherit.aes = F, data= hlines, aes(x = 0, xend = 24*60, y = mims, yend = mims), colour=\"black\", linewidth=0.05) +\n  theme() +\n  ylab(\"Physical activity (mims)\") + \n  xlab(\"Time of day\") + \n  scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80),\n                     limits =c(-20, max_measure)) +\n  theme(axis.line = element_blank(), \n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_blank(),\n        axis.title = element_blank(),\n        axis.ticks = element_blank()) +\n  ggtitle(\"Figure 2: Temporal pattern of entire dataset\")\n\nplot(p2)\n\n\n\n\n\n\n\n\n\n\n\nSee code\n# LINE VERSION\n\np1 &lt;- ggplot(data_plot, aes(x = time, y = mims, group = SEQN)) +\n  facet_grid(age_group~gender) +\n  geom_line(aes(colour = mims), alpha = 0.1) +\n  geom_line(data = mims_summarise_long, inherit.aes = F, aes(x = time, y = mims, group = stat), colour = \"black\") +\n  mims_colour_scale +\n  # coord_polar() +\n  theme_classic() +\n  scale_x_continuous(breaks = c(6, 12, 18, 24)*60, \n                     labels = c(\"6am\", \"12pm\", \"6pm\", \"12am\"), \n                     expand = expansion(0,0))+\n  theme(axis.text.x = element_text(size = 8, angle = 60, hjust = 1)) +\n  ylab(\"Physical activity (mims)\") +\n  xlab(\"Time of day\") +\n  scale_y_continuous(breaks = c(0,10,20,30, 40, 50, 60, 70, 80), \n                     limits =c(0, 90),\n                     expand = expansion(0,0.5)) +\n  labs(title = \"Figure 3: Temporal pattern by sex and age group\",\n       subtitle = \"Black lines show mean and 2.5th and 97.5th quantiles for entire distribution\")\n\n\nplot(p1)\n\n\n\n\n\n\n\n\n\n\n\nDifferences across age and sex\n\n\nSee code\nagg_data &lt;- mims_t %&gt;%\n  group_by(gender, age_group, SEQN) %&gt;%\n  summarise(MIMS_agg = mean(mims))\n\n# PLOT DISTRIBUTIONS BY AGE GROUP AND SEX\np &lt;- ggplot(agg_data, aes(x = gender, fill= gender, y = MIMS_agg)) +\n  facet_wrap(~age_group) +\n  geom_violin() +\n  theme_classic() +\n  labs(title = \"Figure 4: Distribution of physical activity by gender and age group\",\n       subtitle = \"Physical activity is measured by MIMS as described in introduction\") +\n  ylab(\"Average MIMS\") +\n  xlab(\"Gender\")\n\nplot(p)\n\n\n\n\n\n\n\n\n\nSee code\nsex_agg_data &lt;- mims_t %&gt;%\n  group_by(gender, age_group, minute) %&gt;%\n  summarise(MIMS_agg = mean(mims))\n\n# PLOT TRENDS ACROSS TIME BY AGE GROUP AND SEX\np2 &lt;- ggplot(sex_agg_data, aes(x = minute, colour = gender, y = MIMS_agg)) +\n  facet_wrap(~age_group) +\n  geom_line()+\n  theme_classic() +\n  scale_x_continuous(breaks = c(6, 12, 18, 24)*60, \n                     labels = c(\"6am\", \"12pm\", \"6pm\", \"12am\"), \n                     expand = expansion(0,0)) +\n  labs(title = \"Figure 5: Trends across time by age group and sex\") +\n  ylab(\"Average MIMS\") +\n  xlab(\"Time of day\") \n\nplot(p2)\n\n\n\n\n\n\n\n\n\nSee code\ntime_agg_data &lt;- mims_t %&gt;% \n  group_by(gender, age, minute_group) %&gt;%\n  summarise(MIMS_agg = mean(mims))\n\n# PLOT TRENDS ACROSS AGE BY time of day and gender\np3 &lt;- ggplot(time_agg_data, aes(x = age, colour = gender, y = MIMS_agg)) +\n  facet_wrap(~minute_group) +\n  geom_line() +\n  theme_classic() +\n  labs(title = \"Figure 6: Trends across age by gender and time of day\") +\n  ylab(\"Average MIMS\") +\n  xlab(\"Age (years)\")\n\n# PLOT TRENDS ACROSS TIME BY AGE GROUP AND SEX\nlong &lt;- sex_agg_data %&gt;%\n  pivot_wider(names_from = gender, values_from = MIMS_agg) %&gt;%\n  mutate(diff = Male - Female)\n\np4 &lt;- ggplot(long, aes(y = diff, x = minute, col = diff)) +\n  facet_wrap(~age_group) +\n  geom_point(alpha = 0.8) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", colour = \"grey50\") +\n  theme_classic() +\n  scale_x_continuous(breaks = c(6, 12, 18, 24)*60, \n                     labels = c(\"6am\", \"12pm\", \"6pm\", \"12am\"), \n                     expand = expansion(0,0)) +\n  labs(title = \"Figure 7: Difference between physical activity in men and women by time of day\") +\n  ylab(\"Average MIMS (men) - Average MIMS (women)\") +\n  xlab(\"Time of day\") \n\n\nplot(p4)\n\n\n\n\n\n\n\n\n\n\n\nResults and discussion\nThis purely descriptive data analysis found that there are some differences in the patterns of objective (measured) physical activity as found in a cohort in the united states. In particular, we see that men are slightly less physically active than women, especially in older age groups (Figures 5 and Figure 6), although there was also slightly more variability in men compared to women (Figure 4) and overall the trends are very similar across age group and gender (Figure 2). Interestingly, there are some temporal patterns in the differences between men and women (or boys and girls), where for most age groups, men are more physically active at night than women, but women are more physically active during the day (Figure 7). The exception is for children and adolescents, where boys are more physically active than girls during the day.\nWe also see strong temporal patterns in physical activity, as we would naturally expect (Figure 2, Figure 3, Figure 5). We also see decreasing physical activity across age, consistently even when limited to different times of day (Figure 6).\nThese all together indicate that there might be some differences between men and women worth investigating, but these, and age, do not explain most of the variation of the data, and it is worth further exploration of what the drivers of this are in order to effectively identify subgroups for targeted interventions.\n\n\nNote for TAs\nI used the functions select, pivot_longer, mutate, group_by, distinct, and summarise from dplyr and tidyr. I used fucntions geom_line, geom_violin and geom_point.\n\n\n\n\n\nReferences\n\nCrainiceanu, Goldsmith, C. M. 2023. “NHANES.” Functional Data Analysis - NHANES. https://functionaldataanalysis.org/dataset_nhanes.html.\n\n\nLeroux, Andrew, Erjia Cui, Ekaterina Smirnova, John Muschelli, Jennifer A Schrack, and Ciprian M Crainiceanu. 2024. “Nhanes 2011-2014: Objective Physical Activity Is the Strongest Predictor of All-Cause Mortality.” Medicine and Science in Sports and Exercise 56 (10): 1926–34.\n\n\nStrain, Tessa, Seth Flaxman, Regina Guthold, Elizaveta Semenova, Melanie Cowan, Leanne M Riley, Fiona C Bull, and Gretchen A Stevens. 2024. “National, Regional, and Global Trends in Insufficient Physical Activity Among Adults from 2000 to 2022: A Pooled Analysis of 507 Population-Based Surveys with 5 7 Million Participants.” The Lancet Global Health 12 (8): e1232–43."
  }
]